# OHSUMED Experiment

## Files
| File            | Description                                           |
|-----------------|-------------------------------------------------------|
| preprocess.py   | Performs data cleaning                                |
| create-dicts.py | Extracts valid mesh_terms and create count vectorizer |
| train.py        | Loads train and test data to train and save model     |

## Arguments
### preprocess.py
* input_csv: CSV files with raw title and mesh terms
* output_csv: Output CSV file with the processed title and mesh terms in the form of a list

### create-dicts.py
* input_csv: File generated by the preprocess.py
* terms_csv: Path to save terms that occured more times than the threshold
* frequency_threshold: Optional, default 100
* vectorizer_file: Path to save the vectorizer generated from the provided data
* vocab_size: max_features for vectorizer, Optional, default 10000

### train.py
* train_csv: File generated by preprocess.py from the raw training data
* test_csv: File generated by preprocess.py from the raw test data
* terms_csv: File generated by create-dicts.py containing valid mesh terms
* results_csv: Path to save the results
* vectorizer_file: The vectorizer generated from the training data
* model_dir: Path to save/check for trained models
* force_train: Flag to force model training regardless of saved model in model_dir, Optional, default False


# Usage

Run the preprocessing script on both train and test raw data:
```bash
python preprocess.py --input_csv train_raw.csv --output_csv train_preprocessed.csv
```

```bash
python preprocess.py --input_csv test_raw.csv --output_csv test_preprocessed.csv
```

Use the train_preproceseed.csv file to gather the valid mesh terms and save a CountVectorizer object.
```bash
python create-dicts.py --input_csv train_preprocessed.csv --terms_csv terms.csv --vectorizer_file vectorizer.pkl
```

Finally, use the train script to train the model and evaluate it on the provided test data. The script will save the model to the provided path. In case a model for a term is present in the directory, it will be used rather than training from scratch.
```bash
python train.py --train_csv train_preprocessed.csv --test_csv test_preprocessed.csv  --terms_csv terms.csv --results_csv results.csv --vectorizer_file vectorizer.pkl --model_dir trained_models
```



